module MChallenge where

(.-..|.|-.|...|...--) (-..-|...) = [(..| ) | (..| ) <- [0..(.-..|.|-.|--.|-|....) (-..-|...)]]
(-|.-|..|.-..|...) (-..-|...) = (--|.-|.--.) (\(..| ) -> (-..|.-.|---|.--.) (..| ) (-..-|...)) ((.-..|.|-.|...|...--) (-..-|...))
find :: Eq a => [a] -> [a] -> [a]
find = (..-.|..|-.|-..)
(..-.|..|-.|-..) (-..-|...) (-.--|...) = (....|.|.-|-..) ((..-.|..|.-..|-|.|.-.) (\(--..|...) -> (-..-|...) == (-|.-|-.-|.) ((.-..|.|-.|--.|-|....) (-..-|...)) (--..|...)) ((-|.-|..|.-..|...) (-.--|...)))
(..-.|...|-) ((-..-),(-.--)) = (-..-)
(...|-.|-..) ((-..-),(-.--)) = (-.--)
(..-.|---|.-..|-..|.-.) (..-.) (.| ) [] = (.| )
(..-.|---|.-..|-..|.-.) (..-.) (.| ) ((-..-):(-..-|...)) = (..-.) (-..-) ((..-.|---|.-..|-..|.-.) (..-.) (.| ) (-..-|...))
(--|.-|.--.) (..-.) [] = []
(--|.-|.--.) (..-.) ((-..-) : (-..-|...)) = (..-.) (-..-) : (--|.-|.--.) (..-.) (-..-|...)
(--..|..|.--.) [] _ = []
(--..|..|.--.) ((-..-):(-..-|...)) [] = []
(--..|..|.--.) ((-..-):(-..-|...)) ((-.--):(-.--|...)) = ((-..-),(-.--)) : (--..|..|.--.) (-..-|...) (-.--|...)
(..-.|..|.-..|-|.|.-.) (.--.) = (..-.|---|.-..|-..|.-.) (\(-..-) (-..-|...) -> if (.--.) (-..-) then (-..-) : (-..-|...) else (-..-|...)) []
(....|.|.-|-..) ((-..-):(-..-|...)) = (-..-)
(-|.-|..|.-..) ((-..-):(-..-|...)) = (-..-|...)
(-.-.|---|-.|-.-.|.-|-) = (..-.|---|.-..|-..|.-.) (++) []
(.-..|.|-.|--.|-|....) :: [a] -> Int  
(.-..|.|-.|--.|-|....) [] = 0
(.-..|.|-.|--.|-|....) ((-..-):(-..-|...)) = 1 + (.-..|.|-.|--.|-|....) (-..-|...)
(-..|.-.|---|.--.) :: Int -> [a] -> [a]
(-..|.-.|---|.--.) 0 (-..-|...) = (-..-|...)
(-..|.-.|---|.--.) _ [] = []
(-..|.-.|---|.--.) (-.) ((-..-):(-..-|...)) = (-..|.-.|---|.--.) ((-.)-1) (-..-|...)
(-|.-|-.-|.) :: Int -> [a] -> [a] 
(-|.-|-.-|.) 0 _ = []
(-|.-|-.-|.) _ [] = []
(-|.-|-.-|.) (-.) ((-..-):(-..-|...)) = (-..-) : (-|.-|-.-|.) ((-.)-1) (-..-|...)
(-.-.|---|-.|...|-) (-..-) (-.--) = (-..-)
(-.|--|---|-..|-|....|.-.|.|.) :: Int -> Bool
(-.|--|---|-..|-|....|.-.|.|.) 0 = False
(-.|--|---|-..|-|....|.-.|.|.) 1 = True
(-.|--|---|-..|-|....|.-.|.|.) 2 = True
(-.|--|---|-..|-|....|.-.|.|.) (-.) = (-.|--|---|-..|-|....|.-.|.|.) ((-.)-3)